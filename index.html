<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>

<body>

	<script type="module" defer>
		import * as THREE from "./js/three.module.js";
		import { OrbitControls } from "./js/OrbitControls.js";
		import { OBJLoader } from "./js/OBJLoader.js";

		const scene = new THREE.Scene();


		const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
		camera.position.y = 0.25;

		const renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);
		renderer.setClearColor(0xffffff);
		renderer.shadowMap.type = THREE.PCFSoftShadowMap;
		renderer.gammaInput = true;
		renderer.gammaOutput = true;

		document.body.appendChild(renderer.domElement);

		const geometry = new THREE.BoxGeometry(1, 1, 1);
		const material = new THREE.MeshLambertMaterial({ color: 0x00ff00 });
		const cube = new THREE.Mesh(geometry, material);
		cube.castShadow = true;
		scene.add(cube);

		cube.position.y = 1;

		let planeGeomtry = new THREE.PlaneGeometry(20, 20, 1, 1);
		let planeMaterial = new THREE.MeshStandardMaterial({ color: 0xCCCCCC });
		let plane = new THREE.Mesh(planeGeomtry, planeMaterial);
		plane.rotation.x = -0.5 * Math.PI;
		plane.castShadow = true;
		plane.receiveShadow = true;
		scene.add(plane);


		camera.position.z = 3;
		camera.position.y = 10;

		const controls = new OrbitControls(camera, renderer.domElement);
		controls.minDistance = 1;
		controls.maxDistance = 500;

		// const loader = new OBJLoader();
		// loader.load("object/teddy.obj",(root)=>{
		// 	scene.add(root);
		// 	console.log("asd");
		// },()=>{},(e)=>{console.log(e)});

		function setShadowCamera() {
			let helper = new THREE.CameraHelper(camera);
			scene.add(helper);
		}


		let light = new THREE.DirectionalLight(0xffffff, 1.5);
		light.position.set(0.6,0.25,0.25);
		// let light2 = new THREE.SpotLight(0xffffff, 0.5);
		
		light.castShadow = true;
		scene.add(light);
		// setShadowCamera();

		renderer.shadowMap.enabled = true
		plane.receiveShadow = true
		light.castShadow = true
		light.shadow.mapSize.width = 1024
		light.shadow.mapSize.height = 1024

		function animate() {
			requestAnimationFrame(animate);
			controls.update();

			renderer.render(scene, camera);
		};

		animate();
	</script>

</body>

</html>